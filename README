# Connor Burbridge
# Bioinformatics technician
# Global Institute for Food Security
# connor.burbridge@gifs.ca
#
##########################################################################################
# Setup
# script to help automate the dge-read-prep step on a grouped basis
# looks for a samples_config.tsv file formatted as:
# treatment1	read-file0-R1.fq	read-file0-R2.fq	read-file1-R1.fq...
# treatment2	read-file0-R1.fq	read-file2-R2.fq ...
# and so on
# two other files are also required for the script to run:
# one file that contains the BASE NAME of the control read files mentioned above
# i.e.
# read-file0-
# read-file1-
# and the same type of file for the treatment condition. Please make sure that the names
# of these files match the treatment name in the samples_config.tsv file.
# You should also ensure that you have Trimmomatic, FastQC, Hisat2, StringTie, R and the 
# DESeq2 R library installed and in your current path for things to run smoothly.
#
##########################################################################################
# Genome preparation
# Prior to running analysis you should have the genome indexed. You should also have the 
# appropriate gff file for the genome of interest. The genome must me indexed using the
# program Hisat2.
#
##########################################################################################
# Usage
# To run this script, enter the directory that contains the samples_config.tsv, 
# treatment1.txt and treatment2.txt files and run the command below:
# Command: python group-dge-read-prep.py -h
# This will list the correct usage of the available command line parameters
# as well a brief descript of what they do.
#
# usage: group-dge-read-prep.py [-h] [--reads READS] [--threads THREADS] [--sample_count_1 COUNTONE]
#                               [--sample_count_2 COUNTTWO] [--clean CLEAN] [--genome GENOME]
#                               [--gff GFF]
# 
# Main script to use when running differential gene expression pipeline. Make sure to downlaod the
# latest set of scripts from https://github.com/cbe453/GIFS-DESeq2.
# 
#  optional arguments:
#   -h, --help            show this help message and exit
#   --reads READS         full path to to the directory containing the desired read files.
#   --threads THREADS     number of desired threads for processes that support multi-threaded
#                         computation.
#   --sample_count_1 COUNTONE
#                         number of replicates for the first treatment in the samples_config.tsv
#                         file.
#   --sample_count_2 COUNTTWO
#                         number of replicates for the second treatment in the samples_config.tsv
#                         file.
#   --clean CLEAN         if the clean flag is true, remove all output directories and files.
#                         Acceptable values are true or false. Default value is false.
#   --genome GENOME       path and prefex of the Hisat2 indices for the genome of interest.
#   --gff GFF             path and name of the gff file for the genome of interest.
#
##########################################################################################
# This script performs some checks that prevents re-doing analysis when results files are
# are already present. Should the pipeline fail at any step, please remove the output files
# from the most recent step and run the same command again. The pipeline should pick up 
# at that step.
# Also, should you want to remove ALL directories and files generated by the pipeline,
# run the following command from the directory containing the samples_config.tsv and 
# treatment files.
# command: python group-dge-read-prep.py --clean true
# This command will PERMANENTLY delete all results generated from any previous analyses.
# Be careful!
# It is also recommended that you re-direct the STDOUT from this pipeline to a log file
# with a simple > log.txt (or >> log.txt to append) at the end of any command.
#
##########################################################################################
